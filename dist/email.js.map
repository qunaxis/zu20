{"version":3,"sources":["../src/email.js"],"names":["settings","host","port","secure","auth","user","pass","Email","constructor","transporter","createTransport","sendMessage","theme","data","html","console","log","createMasterHtml","createRequestHtml","message","from","to","subject","number","text","sendMail","error","name","phone","secondname","firstname","patronymic","passSerial","passNumber","birth","email","phoneMain","phoneAdditional","services","password","userAgreement","dataProcessed","offerAgreement"],"mappings":";;;;;;AAAA;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMA,WAAW;AACbC,UAAM,gBADO;AAEbC,UAAM,KAFO;AAGbC,YAAQ,IAHK;AAIbC,UAAM;AACFC,cAAM,sBADJ;AAEFC,cAAM;AAFJ;AAJO,CAAjB;;AAUA,MAAMC,KAAN,CAAY;AACRC,kBAAc;AACV,aAAKC,WAAL,GAAmB,qBAAWC,eAAX,CAA2BV,QAA3B,CAAnB;AACH;;AAEDW,gBAAYC,KAAZ,EAAmBC,IAAnB,EAAyB;AACrB,YAAIC,OAAQ,EAAZ;AACA,YAAIF,SAAS,cAAb,EAA6B;AACzBG,oBAAQC,GAAR,CAAY,QAAZ;AACAF,mBAAO,KAAKG,gBAAL,CAAsBJ,IAAtB,CAAP;AACH;AACD,YAAID,SAAS,cAAb,EAA6B;AACzBG,oBAAQC,GAAR,CAAY,QAAZ;AACAF,mBAAO,KAAKI,iBAAL,CAAuBL,IAAvB,CAAP;AACH;AACDE,gBAAQC,GAAR,CAAYF,IAAZ;AACA,YAAIK,UAAU;AACVC,kBAAM,wCADI;AAEV;AACAC,gBAAI,qBAHM;AAIVC,qBAAU,GAAEV,KAAM,KAAIC,KAAKU,MAAO,EAJxB;AAKVC,kBAAM,0DALI;AAMVV,kBAAMA;AANI,SAAd;AAQA,YAAI;AACA,iBAAKL,WAAL,CAAiBgB,QAAjB,CAA0BN,OAA1B;AACH,SAFD,CAEE,OAAMO,KAAN,EAAa;AACXX,oBAAQC,GAAR,CAAYU,KAAZ;AACH;AACJ;;AAEDR,sBAAkBL,IAAlB,EAAwB;AACpB,eAAQ;;;;;;;sBAOMA,KAAKc,IAAK;sBACVd,KAAKe,KAAM;;;SARzB;AAYH;;AAEDX,qBAAiBJ,IAAjB,EAAuB;AACnB,eAAQ;;;;;;;;;;;;;;;;;;;sBAmBMA,KAAKgB,UAAW;sBAChBhB,KAAKiB,SAAU;sBACfjB,KAAKkB,UAAW;sBAChBlB,KAAKmB,UAAW;sBAChBnB,KAAKoB,UAAW;sBAChBpB,KAAKqB,KAAM;sBACXrB,KAAKsB,KAAM;sBACXtB,KAAKuB,SAAU;sBACfvB,KAAKwB,eAAgB;sBACrBxB,KAAKyB,QAAS;sBACdzB,KAAK0B,QAAS;sBACd1B,KAAK2B,aAAc;sBACnB3B,KAAK4B,aAAc;sBACnB5B,KAAK6B,cAAe;;;SAhClC;AAoCH;AAnFO;;AAsFZ,MAAMP,QAAQ,IAAI5B,KAAJ,EAAd;;kBAEe4B,K","file":"email.js","sourcesContent":["import nodemailer from 'nodemailer'\r\n// const settings = {\r\n//     host: 'smtp.yandex.ru',\r\n//     port: '465',\r\n//     secure: true,\r\n//     auth: {\r\n//         user: 'podlesnykh_da@allservice.team',\r\n//         pass: 'Diman222319',\r\n//     }\r\n// }\r\nconst settings = {\r\n    host: 'smtp.yandex.ru',\r\n    port: '465',\r\n    secure: true,\r\n    auth: {\r\n        user: 'site@allservice.team',\r\n        pass: 'TopSiteByTopPeople123',\r\n    }\r\n}\r\n\r\nclass Email {\r\n    constructor() {\r\n        this.transporter = nodemailer.createTransport(settings)\r\n    }\r\n\r\n    sendMessage(theme, data) {\r\n        let html = ``\r\n        if (theme == 'Новый мастер') {\r\n            console.log('Мастер')\r\n            html = this.createMasterHtml(data)\r\n        }\r\n        if (theme == 'Новая заявка') {\r\n            console.log('Заявка')\r\n            html = this.createRequestHtml(data)\r\n        }\r\n        console.log(html)\r\n        let message = {\r\n            from: 'Сайт ALLSERVICE <site@allservice.team>',\r\n            // to: 'qunaxis@gmail.com',\r\n            to: 'all@allservice.team',\r\n            subject: `${theme} #${data.number}`,\r\n            text: 'Откройте письмо в почтовом клиенте, поддерживающем HTML.',\r\n            html: html,\r\n        }\r\n        try {\r\n            this.transporter.sendMail(message)\r\n        } catch(error) {\r\n            console.log(error)\r\n        }\r\n    }\r\n\r\n    createRequestHtml(data) {\r\n        return `\r\n            <table>\r\n            <thead><tr>\r\n                <th title=\"Field #2\">Имя</th>\r\n                <th title=\"Field #1\">Телефон</th>\r\n            </tr></thead>\r\n            <tbody><tr>\r\n                <td>${data.name}</td>                \r\n                <td>${data.phone}</td>                \r\n            </tr></tbody>\r\n        </table>\r\n        `\r\n    }\r\n\r\n    createMasterHtml(data) {\r\n        return `\r\n            <table>\r\n            <thead><tr>\r\n                <th title=\"Field #2\">Фамилия</th>\r\n                <th title=\"Field #1\">Имя</th>\r\n                <th title=\"Field #3\">Отчество</th>\r\n                <th title=\"Field #4\">Серия пасп.</th>\r\n                <th title=\"Field #5\">Номер пасп.</th>\r\n                <th title=\"Field #6\">Дата рождения</th>\r\n                <th title=\"Field #7\">Email</th>\r\n                <th title=\"Field #8\">Телефон осн.</th>\r\n                <th title=\"Field #9\">Телефон доп.</th>\r\n                <th title=\"Field #10\">Сервисы</th>\r\n                <th title=\"Field #11\">Пароль</th>\r\n                <th title=\"Field #13\">Согл. конфиденциальность</th>\r\n                <th title=\"Field #13\">Согл. обр. данных</th>\r\n                <th title=\"Field #13\">Прин. оферту</th>\r\n            </tr></thead>\r\n            <tbody><tr>\r\n                <td>${data.secondname}</td>\r\n                <td>${data.firstname}</td>\r\n                <td>${data.patronymic}</td>\r\n                <td>${data.passSerial}</td>\r\n                <td>${data.passNumber}</td>\r\n                <td>${data.birth}</td>\r\n                <td>${data.email}</td>\r\n                <td>${data.phoneMain}</td>\r\n                <td>${data.phoneAdditional}</td>                \r\n                <td>${data.services}</td>                \r\n                <td>${data.password}</td>              \r\n                <td>${data.userAgreement}</td>                \r\n                <td>${data.dataProcessed}</td>                \r\n                <td>${data.offerAgreement}</td>                \r\n                </tr></tbody>\r\n            </table>\r\n        `\r\n    }\r\n} \r\n\r\nconst email = new Email\r\n\r\nexport default email\r\n\r\n\r\n"]}